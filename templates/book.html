<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>$if(title-prefix)$$title-prefix$ - $endif$$pagetitle$</title>
    <style>
      body {
        font-family: Georgia, serif;
        line-height: 1.6;
        max-width: 650px;
        margin: 0 auto;
        padding: 20px;
        color: #333;
      }
      h1 {
        border-bottom: 2px solid #333;
        padding-bottom: 10px;
      }
      .subtitle {
        font-style: italic;
        color: #666;
        margin-top: -10px;
        margin-bottom: 20px;
        font-size: 1.1em;
      }
      h2 {
        margin-top: 2em;
        color: #555;
      }
      hr {
        background-color: #333;
        border: none;
        height: 2px;
        margin: 2em auto;
        max-width: 50%;
      }
      .header-link {
        color: inherit;
        font-weight: normal;
        margin-right: 10px;
        opacity: 0;
        position: absolute;
        right: 100%;
        text-decoration: none;
        top: 0;
        transition: opacity 0.2s;
      }
      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        position: relative;
        &:hover .header-link {
          opacity: 0.5;
        }
      }
      .nav {
        margin: 30px 0;
        padding: 20px 0;
        border-top: 1px solid #ddd;
        border-bottom: 1px solid #ddd;
        display: flex;
        justify-content: space-between;
      }
      .nav a {
        text-decoration: none;
        color: #0066cc;
        font-weight: bold;
      }
      .nav a:hover {
        text-decoration: underline;
      }
      .toc {
        background: #f5f5f5;
        padding: 20px;
        margin: 20px 0;
        border-radius: 5px;
      }
      .toc h2 {
        margin-top: 0;
      }
      .toc ul {
        list-style-type: none;
        padding-left: 0;
      }
      .toc ul ul {
        padding-left: 1em;
      }
      .toc li {
        margin: 5px 0;
      }
      .toc a {
        text-decoration: none;
        color: #0066cc;
      }
      img {
        max-width: 100%;
        height: auto;
      }
      figcaption {
        font-style: italic;
        text-align: center;
      }
      .license {
        margin-top: 40px;
        padding-top: 20px;
        border-top: 1px solid #ddd;
        text-align: center;
        color: #666;
        font-size: 0.9em;
      }
      .license a {
        color: #0066cc;
        text-decoration: none;
      }
      .license a:hover {
        text-decoration: underline;
      }
    </style>
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [
            ["$$", "$$"],
            ["\\(", "\\)"],
          ],
          displayMath: [
            ["$$$$", "$$$$"],
            ["\\[", "\\]"],
          ],
        },
      };

      // Auto-add anchor links to headers
      document.addEventListener("DOMContentLoaded", function () {
        const headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");
        headers.forEach((header) => {
          if (header.id) {
            const link = document.createElement("a");
            link.href = "#" + header.id;
            link.textContent = "Â¶";
            link.className = "header-link";
            link.title = "Permalink to this section";
            header.appendChild(link);
          }
        });
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
    $if(title)$
    <h1>$title$</h1>
    $endif$ $if(subtitle)$
    <p class="subtitle">$subtitle$</p>
    $endif$ $if(author)$
    <p class="subtitle"><small>Author: $author$</small></p>
    $endif$ $if(date)$
    <p class="subtitle"><small>Version: $date$</small></p>
    $endif$ $if(toc)$
    <div class="toc">
      <h2>Table of Contents</h2>
      $toc$
    </div>
    $endif$ $body$

    <div class="license">
      <p>
        <small>
          This work is licensed under a
          <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"
            >Creative Commons Attribution-NonCommercial-ShareAlike 4.0
            International License</a
          >.
        </small>
      </p>
    </div>
  </body>
</html>
